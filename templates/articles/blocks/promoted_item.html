{% load wagtailcore_tags wagtailimages_tags static %}


{# This template has been developed based on includes/blog-embed.html #}

{# as the category heading and icon are from the block's category field. #}

{# The description field is richtext and can contain repeating <p> tags. #}
{# The outer "-embed__text" <p> tag should probably be changed to a <div> #}

{# All field in the block are currently required fields. If any become optional at a later date, #}
{# the relevant items should be wrapped in {% if %}{% endif %} statements. #}


<div class="promoted-item" data-container-name="promoted-item">
    <div class="container">
        <{{ heading_level }} class="promoted-item__heading">
            {{ value.title }}
        </{{ heading_level }}>

        <div class="promoted-item__image-container">
            {% if value.image %}
                {% include_block value.image %}
            {% endif %}
        </div>

        <div class="promoted-item__metadata">
            {% if value.author %}
            <p class="promoted-item__author">
                By {{ value.author }}
            </p>
            {% endif %}
            
            {% if value.publication_date %}
                <p>{{ value.publication_date }}</p>
            {% endif %}

            {% comment %} TODO: Re-add this when we properly launch blogs, and use an actual a date field
                {% if value.publication_date %}
                    <time datetime="{{ value.publication_date|date:'Y-m-d' }}">{{ value.publication_date|date:'l j F Y' }}</time>
                {% endif %}
            {% endcomment %}
        </div>

        {% if value.duration %}
        <p class="promoted-item__text">
            {{ value.duration }}
        </p>
        {% endif %}

        <div class="promoted-item__text-container">
            <div class="promoted-item__text">
                {{ value.description|richtext }}
            </div>

            {% if value.target_blank %}
                <a class="promoted-item__link tna-button--yellow" href="{{ value.url }}" data-component-name="{{ value.block.meta.label }}: {{ value.category }}" data-link-type="Button" data-link="{{ value.cta_label }}" data-category="{{ value.category }}" target="_blank">{{ value.cta_label }} <span class="tna-button__target-blank-label">(Opens in a new tab)</span></a>
            {% else %}
                <a class="promoted-item__link tna-button--yellow" href="{{ value.url }}" data-component-name="{{ value.block.meta.label }}: {{ value.category }}" data-link-type="Button" data-link="{{ value.cta_label }}" data-category="{{ value.category }}">{{ value.cta_label }}</a>
            {% endif %}
        </div>
    </div>
</div>
