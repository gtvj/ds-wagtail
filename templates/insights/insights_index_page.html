{% extends 'base_page.html' %}

{% load static %}
{% load i18n %}
{% load wagtailcore_tags %}
{% load wagtailimages_tags %}

{% block content %}
    {% include 'includes/generic-intro.html' %}
    <div class="container">
        <h2 class="sr-only">{% trans "Each collection insight takes an in-depth look into a group of the records we hold." %}</h2>
    </div>

    {% if page.featured_insight %}
    <div class="container">
        <div class="featured-insight">
            {% if page.featured_insight.hero_image %}
                <a href="{% pageurl page.featured_insight %}" class="featured-insight__image-link" tabindex="-1" aria-hidden="true" data-component-name="Featured Insight: {{ page.featured_insight.title }}" data-link-type="Image" {% if page.first_published_at.date > page.new_label_end_date.date %}data-label = "New"{%endif%}>
                    <picture>
                        {% image page.featured_insight.hero_image fill-500x400-c100 as hero %}
                        <source media="(max-width: 768px)" srcset="{{ hero.url }}">
                        {% image page.featured_insight.hero_image fill-500x500-c100 as hero %}
                        <source media="(max-width: 991px)" srcset="{{ hero.url }}">
                        {% image page.featured_insight.hero_image fill-1000x600-c100 as hero %}
                        <source media="(max-width: 1200px)" srcset="{{ hero.url }}">

                        {% if page.featured_insight.hero_image_decorative %}
                            <img src="{{ hero.url }}" alt="" />
                        {% else %}
                            <img src="{{ hero.url }}" alt="{{page.featured_insight.hero_image_alt_text}}" />
                        {% endif %}
                    </picture>
                </a>
            {% endif %}

            <div class="featured-insight__description">
                <h2 class="featured-insight__heading">
                    <small>{% trans "Spotlight on" %}</small>
                    {{ page.featured_insight.title }}
                    <span aria-describedby="populate via wagtail?" role="label">NEW</span>
                </h2>

                <p>{{ page.featured_insight.sub_heading }}</p>
                <a class="tna-button--dark" href="{% pageurl page.featured_insight %}" data-component-name="Featured Insight: {{ page.featured_insight.title }}" data-link-type="Button" {% if page.first_published_at.date > page.new_label_end_date.date %}data-label = "New"{%endif%}>Read</a>
            </div>
        </div>
    </div>
    {% endif %}

    <div class="container">
        {% include_block page.featured_collections %}
    </div>

    <div class="container mt-4" data-container-name="{{ page.title }}">
        <h2>Discover all stories</h2>
        <p>Browse and explore the human stories behind The National Archivesâ€™ collection.</p>
        <ul class="card-group--list-style-none">

            {% for insights_page in insights_pages %}
                      {% if insights_page not in featuredcollections %}
                        {% with page=insights_page.specific %}
                         {% include 'includes/card-group-secondary-nav.html' with heading="Discover all stories" %}
                        {% endwith %}
                      {% endif %}
            {% endfor %}
        </ul>
    </div>

{% endblock %}

{% block extra_js %}
    <script src="{% static 'scripts/insights_index_page.js' %}"></script>
{% endblock %}
