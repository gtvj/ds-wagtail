{% extends "base.html" %}

{% load search_tags %}
{% load humanize %}

{% block content %}

    {%  with type='Featured'%}
        {% include './blocks/search_results_hero.html' %}
    {% endwith  %}
    <p class="search-results__explainer--desktop">This page displays a summary of catalogue and non-catalogue content that matches your search.</p>
    <p class="search-results__explainer--mobile">Catalogue and non-catalogue content that matches your search.</p>
    <div class="featured-search__results">
        {% with heading='Records from The National Archives' %}
            {% include './blocks/featured-search__results-block.html'%}
        {% endwith %}
        {% with heading='Records from other UK archives' %}
            {% include './blocks/featured-search__results-block.html'%}
        {% endwith %}
        {% with heading='Record creators' %}
        {% include './blocks/featured-search__record-creator.html'%}
    {% endwith %}
    </div>
    <div class="featured-search__interpretive-results">
        <div class="featured-search__interpretive-results-section">
            <h2 class="featured-search__heading">Research guides</h2>
            {% include './blocks/featured-search__interpretive-card.html' %}
            <a href="#" class="featured-search__results-link">See all relevant research guides (8)</a>
        </div>
        <div class="featured-search__interpretive-results-section">
            <h2 class="featured-search__heading">Stories from the collection</h2>
            {% include './blocks/featured-search__interpretive-card.html' %}
            <a href="#" class="featured-search__results-link">See all relevant stories from the collection (8)</a>
        </div>
        <div class="featured-search__interpretive-results-section">
            <h2 class="featured-search__heading">Blogs</h2>
            {% include './blocks/featured-search__interpretive-card.html' %}
            <a href="#" class="featured-search__results-link">See all relevant blog posts (8)</a>
        </div>
    </div>

  
        <p>The loop for results will need to be separated from the loop for interpretive results.</p>
        <div>
            {% for response, bucket in responses %}
            <h5>{{ bucket.heading }}</h5>
            <ul>
                {% for record in response.hits.hits %}
                <li>{{record|record_detail:"summaryTitle"|striptags }}</li>
            {% endfor %}
            </ul>
            <a href="{% url 'search-catalogue' %}?q={{ form.q.value }}&group={{ bucket.aggregation }}">
                See all {{ bucket.heading }} ({{ response.hits.total.value|intcomma }})
            </a>
        {% endfor %}
        </div> 


{% endblock %}
