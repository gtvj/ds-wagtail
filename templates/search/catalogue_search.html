{% extends "base.html" %}

{% load search_tags %}
{% load humanize %}

{% block content %}
    <form method="get">
    {% include './blocks/search_results_hero.html' %}
     
            {{ form.non_field_errors }}

            {% include './blocks/search_buckets.html' %}
            {% comment %} TODO make this text an editable field {% endcomment %}
            <p class="search-results__explainer--desktop">This page displays search results for records that are held at The National Archives, Kew.</p>
            <p class="search-results__explainer--mobile">Results for records held at The National Archives, Kew.</p>
            {% include './blocks/search_sort_and_view_options.html' %}

            <div>
            {{ form.group.errors }}
            {{ form.group.as_hidden }}
            </div>

            <div>
            {{ form.filter_keyword.errors }}
            {{ form.filter_keyword.label_tag }}
            {{ form.filter_keyword }}
            </div>

            {% if form.levels.field.choices %}
                <div>
                {{ form.levels.errors }}
                {{ form.levels.label_tag }}
                {{ form.levels }}
                </div>
            {% endif %}

            {% if form.topics.field.choices %}
                <div>
                {{ form.topics.errors }}
                {{ form.topics.label_tag }}
                {{ form.topics }}
                </div>
            {% endif %}

            {% if form.collections.field.choices %}
                <div>
                {{ form.collections.errors }}
                {{ form.collections.label_tag }}
                {{ form.collections }}
                </div>
            {% endif %}

        <div>
           {{ form.sort_by.errors }}
           {{ form.sort_by.label_tag }}
           {{ form.sort_by }}
        </div>

        <div>
           {{ form.sort_order.errors }}
           {{ form.sort_order.as_hidden }}
        </div>

        <div>
           {{ form.filter_keyword.errors }}
           {{ form.filter_keyword.label_tag }}
           {{ form.filter_keyword }}
        </div>
            {% if form.closure_statuses.field.choices %}
                <div>
                {{ form.closure_statuses.errors }}
                {{ form.closure_statuses.label_tag }}
                {{ form.closure_statuses }}
                </div>
            {% endif %}

            {% if form.catalogue_sources.field.choices %}
                <div>
                {{ form.catalogue_sources.errors }}
                {{ form.catalogue_sources.label_tag }}
                {{ form.catalogue_sources }}
                </div>
            {% endif %}

            <input type="submit" />
        </form>




        {% if form.catalogue_sources.field.choices %}
            <div>
               {{ form.catalogue_sources.errors }}
               {{ form.catalogue_sources.label_tag }}
               {{ form.catalogue_sources }}
            </div>
        {% endif %}

        <fieldset>
            <legend>Record Opening Date</legend>
            <div>
               {{ form.start_date.errors }}
               {{ form.start_date.label_tag }}
               {{ form.start_date }}
            </div>

            <div>
               {{ form.end_date.errors }}
               {{ form.end_date.label_tag }}
               {{ form.end_date }}
            </div>
        </fieldset>

        <input type="submit" />
    </form>


</div>

{% if page.paginator.count %}
    <div class="column results">

        {% with count=page.paginator.count per_page=page.paginator.per_page  %}
        <p>Showing {% if count < per_page %}{{ count }}{% else %}{{ per_page }}{% endif %} (of {{ count|intcomma }}) result{{ count|pluralize}} for "{{ form.q.value|default:'*' }}" in "{{ form.group.value }}"</p>
        {% endwith %}

        <ul>
          {% for record in page %}
            <li>
                <h3> {{ record|record_title }} </h3>

                <dl>
                    <dt>IAID:</dt>
                    <dd>{{ record|record_iaid }}</dd>
                    <dt>Score:</dt>
                    <dd>{{ record|record_score }}</dd>
                </dl>
            </li>
          {% endfor %}
        </ul>

        <nav class="pagination" role="navigation" aria-label="Records pagination" data-container-name="Pagination"
             id="analytics-disambiguation-pagination">
            {% if page.has_other_pages %}
                <ul class="pagination__list">
                    {% if page.has_previous %}
                        <li class="pagination__list-item">
                            <a class="pagination__page-chevron-previous" href="?{% query_string page=page.previous_page_number %}"><span
                                    class="sr-only" data-link="Previous page">Previous page</span></a>
                        </li>
                    {% else %}
                        <li class="pagination__list-item">
                            <span class="pagination__page-chevron-previous--disabled"></span>
                        </li>
                    {% endif %}
                    <li class="pagination__list-pages" aria-label="Page numbers">
                        <ol>
                            {% for i in page_range %}
                                <li class="pagination__list-item">
                                    {% if page.number == i %}
                                        <a class="pagination__page-link-current" href="?{% query_string page=i %}" aria-label="Current page, Page {{ i }}" aria-current="true" data-link="{{ i }}">
                                            <span class="sr-only">Current page </span>{{ i }}
                                        </a>
                                    {% else %}
                                        {% if i == page.paginator.ELLIPSIS %}
                                            {{ i }}
                                        {% else %}
                                            <a class="pagination__page-link" href="?{% query_string page=i %}" aria-label="Go to page {{ i }}" data-link="{{ i }}">
                                                <span class="sr-only">Page </span>{{ i }}
    {% if page.paginator.count %}
        <div class="column results">

            {% with count=page.paginator.count per_page=page.paginator.per_page  %}
            <p>Showing {% if count < per_page %}{{ count }}{% else %}{{ per_page }}{% endif %} (of {{ count|intcomma }}) result{{ count|pluralize}} for "{{ form.q.value|default:'*' }}" in "{{ form.group.value }}"</p>
            {% endwith %}

            <ul>
            {% for record in page %}
                <li>
                    <h3> {{ record|record_title }} </h3>

                    <dl>
                        <dt>IAID:</dt>
                        <dd>{{ record|record_iaid }}</dd>
                        <dt>Score:</dt>
                        <dd>{{ record|record_score }}</dd>
                    </dl>
                </li>
            {% endfor %}
            </ul>

            <nav class="pagination" role="navigation" aria-label="Records pagination" data-container-name="Pagination"
                id="analytics-disambiguation-pagination">
                {% if page.has_other_pages %}
                    <ul class="pagination__list">
                        {% if page.has_previous %}
                            <li class="pagination__list-item">
                                <a class="pagination__page-chevron-previous" href="?{% query_string page=page.previous_page_number %}"><span
                                        class="sr-only" data-link="Previous page">Previous page</span></a>
                            </li>
                        {% else %}
                            <li class="pagination__list-item">
                                <span class="pagination__page-chevron-previous--disabled"></span>
                            </li>
                        {% endif %}
                        <li class="pagination__list-pages" aria-label="Page numbers">
                            <ol>
                                {% for i in page_range %}
                                    <li class="pagination__list-item">
                                        {% if page.number == i %}
                                            <a class="pagination__page-link-current" href="?{% query_string page=i %}" aria-label="Current page, Page {{ i }}" aria-current="true" data-link="{{ i }}">
                                                <span class="sr-only">Current page </span>{{ i }}
                                            </a>
                                        {% else %}
                                            {% if i == page.paginator.ELLIPSIS %}
                                                {{ i }}
                                            {% else %}
                                                <a class="pagination__page-link" href="?{% query_string page=i %}" aria-label="Go to page {{ i }}" data-link="{{ i }}">
                                                    <span class="sr-only">Page </span>{{ i }}
                                                </a>
                                            {% endif %}
                                        {% endif %}
                                    </li>
                                {% endfor %}
                            </ol>
                        </li>
                        {% if page.has_next %}
                            <li class="pagination__list-item">
                                <a class="pagination__page-chevron-next" href="?{% query_string page=page.next_page_number %}"
                                data-link="Next page"><span class="sr-only">Next page</span></a>
                            </li>
                        {% else %}
                            <li class="pagination__list-item">
                                <span class="pagination__page-chevron-next--disabled"></span>
                            </li>
                        {% endif %}
                    </ul>
                {% endif %}
            </nav>
        </div>
    {% endif %}
{% endblock %}