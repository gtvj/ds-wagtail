{% load search_tags %}

<div class="search-filters">
    <h2 class="sr-only">Edit filters</h2>
    <form action="" method="GET" data-id="filters-form"  id="catalogue-filters-form">
        {% prepare_form_for_partial_render form 'filter_keyword' 'collections' 'topics' 'levels' 'closure_statuses' 'start_date' 'end_date' 'catalogue_sources' %}

        {% comment %}
         {% if form.group.value == 'group:tna' %}
            <div class="search-filters__form-block">
                TODO make this a django form element
                <input type="checkbox" class="search-filters__checkbox" id="online-only" name="online-only">
                <label for="online-only" class='search-filters__label'>Show online records only</label>
                <input type="submit" value="Update" class="search-filters__submit">
            </div>
            {% endif %} 
        {% endcomment %}

        <div class="search-filters__form-block">

            <label for="{{form.filter_keyword.id_for_label}}" class="search-filters__label--block">Search within results:</label>
            {{ form.filter_keyword }}
            {{ form.filter_keyword.errors }}
            <input type="submit" value="Search" class="search-filters__submit">
        </div>

        <div class="search-filters__form-block">

            {% comment %} Hidden on archive & creator as they currently have no filters  {% endcomment %}
            {% if not form.group.value == "group:archive" and not form.group.value == "group:creator" %}
                <h3>Refine results by</h3>
            {% endif %}

            {% comment %} <div class="search-filters__accordion-section">
                <fieldset>
                    <legend>
                        <h4 class="search-filters__accordion-section-heading">Date</h4>
                    </legend>

                    <div>
                        <input type="checkbox" name="date-example" id="date-example">
                        <label for="date-example" class='search-filters__label'>Example century goes here</label>
                    </div>

                    <input type="submit" value="Update" class="search-filters__submit">
                </fieldset>
                
            </div> {% endcomment %}

            {% if form.collections.field.choices %}
            <div class="search-filters__accordion-section">
                <!-- <h4 class="search-filters__accordion-section-heading"><a href="/search/long-filters/?type=collections" class="search-filters__accordion-section-link">View collection filters</a></h4> -->
                <fieldset>
                    <legend><h4 class="search-filters__accordion-section-heading">Collections</h4></legend>
                <div>
                    {{ form.collections.errors }}
                    {{ form.collections }}
                </div>
                <a href="{% url 'search-catalogue-long-filter-chooser' %}?{{ request.GET.urlencode }}" >See more</a>
                <input type="submit" value="Update" class="search-filters__submit">
                </fieldset>
            
            </div>
            {% endif %}

            {% if form.topics.field.choices %}
            <div class="search-filters__accordion-section">
                <fieldset>
                    <legend><h4 class="search-filters__accordion-section-heading">Topics</h4></legend>
                <!-- <h4 class="search-filters__accordion-section-heading"><a href="/search/long-filters/?type=topics" class="search-filters__accordion-section-link">View topic filters</a></h4> -->
                <div>
                    {{ form.topics.errors }}
                    {{ form.topics }}
                </div>
                <input type="submit" value="Update" class="search-filters__submit">
                </fieldset>
            </div>
            {% endif %}

            {% if form.levels.field.choices %}
            <div class="search-filters__accordion-section">
                <fieldset>
                    <legend><h4 class="search-filters__accordion-section-heading">Catalogue level</h4></legend>

                    {{ form.levels.errors }}
                    {{ form.levels }}

                    <input type="submit" value="Update" class="search-filters__submit">
                </fieldset>
            </div>
            {% endif %}

            {% if form.closure_statuses.field.choices %}
                <div class="search-filters__accordion-section">
                    <fieldset>
                        <legend><h4 class="search-filters__accordion-section-heading">Closure status</h4></legend>

                        <div>
                            {{ form.closure_statuses.errors }}
                            {{ form.closure_statuses }}
                        </div>
                        <input type="submit" value="Update" class="search-filters__submit">
                    </fieldset>
                </div>
            {% endif %}
            {% if form.group.value == 'group:tna' or form.group.value == 'group:digitised' %}
            <div class="search-filters__accordion-section">
                <fieldset>
                    <legend>
                        <h4 class="search-filters__accordion-section-heading" id="record_opening_date">Record opening date</h4></legend></fieldset>
                    <p id="search_filters__opening-date-help-text">Helper text here (needed for when YYYY MM DD are eventually made separate fields)</p>

                    <div class="search-filters__opening-date-section">
                        {{ form.start_date.errors }}
                        {{ form.start_date.label_tag }}
                        {{ form.start_date }}
                    </div>
                    <div class="search-filters__opening-date-section">
                        {{ form.end_date.errors }}
                        {{ form.end_date.label_tag }}
                        {{ form.end_date }}
                    </div>

                    <input type="submit" value="Update" class="search-filters__submit">
            </div>
            {% endif %}
            {% if form.catalogue_sources.field.choices and form.group.value == 'group:nonTna' %}
            <div class="search-filters__accordion-section">
                <fieldset>
                    <legend>
                        <h4 class="search-filters__accordion-section-heading">Held by</h4>
                    </legend>
                    <div>
                        {{ form.catalogue_sources.errors }}
                        {{ form.catalogue_sources }}
                    </div>
                    <input type="submit" value="Update" class="search-filters__submit">
                </fieldset>
            </div>
            {% endif %}
        </div>
        {% for hidden_field in form.hidden_fields %}
            {{hidden_field}}
        {% endfor %}
    </form>
    {% comment %} {% include './search_export_and_share.html' %} {% endcomment %}
</div>
